---
layout: post
title: SonarQube 5.x, mejorando más y más
date: '2015-01-12T12:42:00.003+01:00'
author: Antonio Calero
categories:
- calidad
- sonarqube
modified_time: '2015-01-12T12:47:27.544+01:00'
blogger_id: tag:blogger.com,1999:blog-6299073294914176200.post-4963147004163483415
blogger_orig_url: http://opinion.excentia.es/2015/01/sonarqube-5x-mejorando-mas-y-mas.html
---

Hace muy poco que finalizó la ronda de versiones 4.x con el anuncio de la versión 4.5.1 LTS (<i>Long Term Support</i>) y al mismo tiempo ya estaba el equipo de SonarSource sentado para recopilar y hablar de todo lo que esta por llegar a las versiones 5.x.<br /><br />Hay muchas cosas nuevas y todas ellas son muy interesantes, en <b>excentia</b>, <i>partners oficiales de SonarSource en Latinoamérica y partners oficiales y exclusivos en España</i>, queremos compartir todas las novedades previstas con vosotros.<br /><br />En la serie 5.x el objetivo de la plataforma SonarQube es convertirse en:<br /><ul><li><b>Una plataforma completamente operativa para los desarrolladores</b>: para gestionar fácilmente la deuda técnica diaria, y con características de navegación cruzada por el código "reales"</li></ul><ul><li><b>Una plataforma mejorada para las grandes organizaciones</b>: a través de el aumento de rendimiento y de la escalabilidad para grandes instancias, y no más acceso a base de datos durante el análisis (¡por fin!)</li></ul><br /><span style="font-size: large;"><b>Gestión diaria de la deuda técnica</b></span><br /><br /><b><i>La página de evidencias como el centro de todo</i></b><br /><b><br /></b>Si un día llegas a casa y te encuentras con que tienes todo el suelo inundado de agua, ¿qué es lo primero que haces? ¿Agarras una fregona, o buscas y reparas la fuente donde está la fuga de agua? Es exactamente lo mismo con la deuda técnica. <b>Lo primero por lo que debes preocuparte es parar el incremento de deuda (reparar la fuga) antes de ponerte a reparar la deuda técnica existente (fregar el suelo).</b><br /><br />Hasta ahora, la plataforma siempre había sido genial para encontrar en que partes del código se localizaba la deuda técnica, pero no era el mejor sitio donde los desarrolladores pudieran gestionar la deuda técnica que introducen cada día. Actualmente lo que puedes hacer es suscribirte a las notificaciones de nuevas evidencias, pero eso es todo. Eso es un problema porque los desarrolladores deberían poder ser capaces de acudir a SonarQube para que les ayude en su día a día.<br /><br />Para conseguir cambiar esto se hará que <b>la página de evidencias sea el centro</b>. Se va a rediseñar para permitir a los usuarios filtrar evidencias de forma eficiente gracias a las "facetas". Por ejemplo, será mucho menos costoso visualizar "todas las evidencias bloqueantes y críticas asignadas a mí en el proyecto X" con una distribución por regla. Otro ejemplo: "todas las evidencias críticas de JavaScript en el proyecto X".<br /><br />Con estas nuevas capacidades, la página de evidencias sustituirá inevitablemente la antigua página de "detalle de evidencias" (Issues Drilldown) y eliminará de un plumazo todas sus limitaciones (poca flexibilidad en los filtros, conteos que no se actualizan cuando las evidencias se modifican desde la interfaz de usuario, ...). En otras palabras, a la hora de enfrentarse a las evidencias y la deuda técnica, los usuarios irán redirigidos al nuevo espacio de evidencias, y se beneficiarán de todas esas nuevas características.<br /><br /><b>Las evidencias tendrán también un mecanismo de etiquetas</b> para ayudar a los desarrolladores a clasificar la deuda técnica pendiente. Cada evidencia heredará las etiquetas asociadas de su regla, para que sea más fácil encontrar evidencias de "seguridad", por ejemplo. Y los usuarios serán capaces de añadir o eliminar etiquetas adicionales siempre que lo deseen. Esto les ayudará a tener una visión más clara de lo que significa la deuda técnica en su proyecto: ¿se trata principalmente de defectos o simplemente de errores de convención de nombres? ¿evidencias relacionadas con un antiguo "framework-legacy" o evidencias de la nueva arquitectura de desarrollo?<br /><br /><b><i>El desarrollador como centro de la gestión de la deuda técnica</i></b><br /><br />Todas estas características en la página de evidencias son inútiles si tú, como desarrollador, siempre tienes que acudir a la página y jugar con las diferentes "facetas" que te permiten encontrar lo que estas buscando. En lugar de eso, <b>SonarQube debe saber que es lo que te preocupa a ti como desarrollador</b>, por ejemplo, debe ser capaz de identificar e informar sobre "tú" código. Esta es la principal razón por la que el plugin SCM Activity acabará muriendo y resurgirá como una funcionalidad del núcleo en SonarQube - con soporte para Git y Subversion (y otros gestores a través de plugins dedicados). <b>Esto permitirá que SonarQube sepa los cambios que pertenecen a cada desarrollador, y automáticamente se asignen las evidencias a los usuarios correspondientes</b>. Ya no hará falta que tengas que navegar por todo la deuda cada día para encontrar la que tú has generado.<br /><br /><span style="font-size: large;"><b>Navegación cruzada "real" por el código</b></span><br /><br />Desde hace algún tiempo SonarQube es capaz de enlazar ficheros bajo determinadas circunstancias - a través de duplicados (puedes navegar por los ficheros que tienen bloques en común con tu código) o a través de los métodos de test (cuando la cobertura por test está activada, puedes navegar por el fichero de test que cubre tu código, viceversa). Pero esta navegación es limitada, y el concepto de espacio de trabajo asociado es la prueba que lo demuestra: el contexto está restringido al contexto del visor de componentes.<br /><br />Gracias a todas las mejoras incluidas en los plugins de lenguajes, ahora <b>SonarQube será capaz de saber si una variable o función está definida dentro o fuera del fichero actual, y llevarte a su definición</b>. Esta nueva funcionalidad puede ayudar a los desarrolladores a entender las evidencias mucho más rápido y mejor aún, sin necesidad de abrir el entorno de desarrollo (IDE). Nunca más tendrás que imaginarte donde un atributo que no debe ser nulo pero lo es está definido. Serás capaz de moverte a la definición de la clase desde la interfaz de usuario. Y si navegas muy lejos del punto inicial, <b>SonarQube te ayudará a recordar el camino, y te dará acceso rápido a los ficheros que has accedido recientemente</b> - independientemente de donde estén. De hecho, el objetivo es conseguir que SonarQube sea el punto central en el que se pueda echar un vistazo al código sin invertir mucho esfuerzo en ello (sin tener que acudir a un equipo de desarrollo, abrir un IDE, hacer un pull del código del repositorio, compilar, ...).<br /><br /><br /><span style="font-size: large;"><b>Escalabilidad y rendimiento</b></span><br /><br />SonarQube comenzó como una aplicación pequeña que ha ido progresando gradualmente hasta conseguir ser una aplicación para grandes organizaciones. Pero todavía tiene un <b>talón de Aquiles que es la base de datos relacional</b> de la que depende. Este es el cuello de botella cada vez que se intenta mejorar la escalabilidad y el rendimiento. Y lo que es peor, dar soporte a cuatro diferentes fabricantes de base de datos multiplica la complejidad de escribir sentencias SQL eficientes. Así que incluso manteniendo la base de datos como el lugar donde asegurar la integridad de los datos, actualizar esos datos con los resultados de los análisis deberían hacerse a través del servidor, y las búsquedas tienen que usar una tecnología diseñada para hacer consultas a grandes cantidades de datos. <b>La tecnología utilizada ha sido Elasticsearch (ES).</b><br /><br />A través de las versiones 5.x, la mayoría de dominios se irán indexando lentamente en ES, y como resultado se obtendrá una mejora sustancial del rendimiento a la hora de requerir esos datos. Esto además permitirá abrir nuevos frentes para implementar funcionalidad que era inaccesible con una base de datos relacional - como las "facetas" incluidas en las páginas de reglas y evidencias. Y como ES está diseñado para escalar, <b>SonarQube se beneficiará de su habilidad para obtener un rendimiento espectacular cuando se añadan nuevas funcionalidades en instancias grandes con millones de evidencias y líneas de código</b>.<br /><br /><span style="font-size: large;"><b>Desacoplando los análisis de la base de datos</b></span><br /><br /><a href="https://jira.codehaus.org/browse/SONAR-2119">El asunto más votado en JIRA</a> es uno de los principales retos cuando se trata de configurar SonarQube en grandes compañías: ¿por qué se hacen tantas consultas a la base de datos cuando se hace un análisis? ¿por qué incluso se necesita una conexión? Esto provoca problemas de rendimiento (cuando los análisis se realizan en maquinas que no están "cerca" de la base de datos) y también problemas de seguridad (los credenciales de base de datos son necesarios para los análisis y algunos puertos especiales deben estar abiertos).<br /><br />Las versiones 5.x irán progresivamente eliminando las dependencias con la base de datos para que al final el análisis simplemente genere un informe que se envía al servidor para procesarlo. Esto no solo permitirá evitar los problemas de rendimiento y de seguridad, sino que también permitirá mejorar el diseño de toda la arquitectura de la plataforma, estableciendo diferentes componentes con sus propias responsabilidades. Al final, <b>el análisis solamente tendrá que invocar a los analizadores que proveen los plugins de lenguajes, consiguiendo que el análisis sea tremendamente rápido</b>. Todo lo relacionado con la agregación de datos y los históricos (que requieren muchos accesos a la base de datos) se manejarán desde un motor dedicado en la parte servidora. La integración en el IDE también se beneficiará de esta separación porque solo se ejecutarán los plugins de lenguajes en lugar de todo el proceso, permitiendo la oportunidad de ejecutar análisis en tiempo real.<br /><br /><span style="font-size: large;"><b>Mecanismo mejorado de autenticación y autorización&nbsp;</b></span><br /><div><br /></div><div>Hace unas cuantas versiones que ya se inició un camino para romper el sistema de permisos en elementos más pequeños. El objetivo es ser capaces de tener más control sobre cada una de las secciones disponibles en la plataforma, y ser capaces de definir y personalizar los roles. Esto es muy importante especialmente a nivel de proyecto, donde actualmente solo hay cuatro tipos de permiso, y no permiten mucha flexibilidad sobre lo que pueden o no pueden hacer los usuarios en un proyecto.</div><div><br /></div><div>En la parte de autenticación, el foco será proveer de una solución de referencia Single Sign-On (SSO) basada en cabeceras HTTP, que es la forma más conveniente y utilizada en todas las implementaciones de las grandes compañías. Los token de autenticación para la API también permitirán eliminar la necesidad de pasar las credenciales a través de la red para los análisis o en la configuración del IDE.</div><div><br /></div><div><span style="font-size: large;"><b>Todo esto y muchas más características...&nbsp;</b></span></div><div><br /></div><div>Esos son los principales temas a abordar durante 2015 con las versiones 5.x de la plataforma, pero obviamente habrán muchas otras mejoras "pequeñas" que se harán realidad. Todas ellas muy importantes y que permitirán seguir creciendo al ecosistema de SonarQube para ser la plataforma de referencia en la inspección continua de código y la gestión de la deuda técnica.</div><div><br /></div><div>¡Todo siempre con pasión y entusiasmo!</div><div><br /></div><div>¡Bienvenido al 2015 y bienvenidas las versiones 5.x de SonarQube!<br /><br /><br /><br /><div style="text-align: right;"><i>Artículo original de&nbsp;<b>Fabrice Bellingard</b>, lidera el equipo de desarrollo de SonarQube</i></div><div style="text-align: right;"><a href="http://www.sonarqube.org/sonarqube-5-x-series-it-just-keeps-getting-better-and-better/"><i>&gt; Ver artículo original</i></a><br /><div style="-webkit-text-stroke-width: 0px; color: black; font-family: Times; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: right; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px;"><div style="margin: 0px;">________________________________</div></div></div></div><div><br /></div>